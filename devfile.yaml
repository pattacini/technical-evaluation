apiVersion: 1.0.0
metadata:
  generateName: technical-evaluation-workspace-
projects:
  - name: technical-evaluation
    source:
      type: github
      location: 'https://github.com/pattacini/technical-evaluation.git'
      branch: master
components:
  - alias: theia-editor
    type: cheEditor
    id: eclipse/che-theia/next
  - alias: docker
    type: dockerimage
    image: 'pattacini/technical-evaluation-stack:eclipse-che'
    memoryLimit: 1024M
    mountSources: true
    endpoints:
     - name: markdown
       port: 8080
       attributes:
         discoverable: 'false'
         public: 'true'
         protocol: http
     - name: jupyter
       port: 8888
       attributes:
         discoverable: 'false'
         public: 'true'
         protocol: http
     - name: x11vnc
       port: 5901
       attributes:
         discoverable: 'false'
         public: 'true'
         protocol: http
     - name: noVNC
       port: 6080
       attributes:
         discoverable: 'false'
         public: 'true'
         protocol: http
commands:
  - name: X11 server
    actions:
     - type: exec
       component: docker
       command: X :1 -config /etc/X11/xorg.conf & && startxfce4 & && x11vnc -display :1 -N -forever -shared &
       workdir: '${CHE_PROJECTS_ROOT}'
  - name: Markdown server
    actions:
     - type: exec
       component: docker
       command: markserv --browser false -a 0.0.0.0 -p 8080 &
       workdir: '${CHE_PROJECTS_ROOT}'
  - name: Jupyter server
    actions:
     - type: exec
       component: docker
       command: jupyter notebook --ip=0.0.0.0 --port=8888 --no-browser --allow-root --NotebookApp.token='' --NotebookApp.password='' &
       workdir: '${CHE_PROJECTS_ROOT}'
  - name: noVNC server
    actions:
     - type: exec
       component: docker
       command: /opt/novnc/utils/launch.sh --web /opt/novnc/ --listen 6080 --vnc 0.0.0.0:5901 &
       workdir: '${CHE_PROJECTS_ROOT}'
